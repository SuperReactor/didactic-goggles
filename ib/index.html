<!DOCTYPE html>
<html lang="en">

<head>
    <link rel="icon" sizes="192x192" href="img/favicon.png" />
    <link rel="shortcut icon" href="img/favicon.png" type="image/x-icon" />
    <link rel="apple-touch-icon" href="img/favicon.png" type="image/x-icon" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta http-equiv="pragma" content="no-cache" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta charset="utf-8" />
    <meta content="img/thumbnail.png" property="og:image" />
    <meta content="#000000" data-react-helmet="true" name="theme-color" />
    <meta name="title" content="3kh0.github.io" />
    <meta name="description"
        content="Build the ultimate brick-busting machine to destroy billions of bricks. Idle breakout combines classic brick breaking with an insanely addicting idle loop." />
    <meta name="keywords" content="games, ad blocker, trolls, unblocked games, web games, online games, fun, tags" />
    <meta name="robots" content="index, follow" />
    <meta name="language" content="English" />
    <meta name="revisit-after" content="1 days" />
    <base href="https://cdn.jsdelivr.net/gh/55gms/55gms@master/static/misc/idle-breakout/">
    <meta name="author" content="3kh0" />

    <title>Idle breakout · real units + sliders + auto‑fit</title>

    <!-- Lucide icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* ----- full viewport layout – auto‑fit ----- */
        * {
            box-sizing: border-box;
        }

        html,
        body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background: #0a0c0e;
            color: #e0e4e7;
            font-family: 'Segoe UI', 'Inter', system-ui, -apple-system, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .gm4html5 {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 12px 16px;
            gap: 16px;
        }

        /* ----- control panel – units, sliders, lucide ----- */
        .size-panel {
            background: #141a1e;
            padding: 1.2rem 2rem;
            border-radius: 40px;
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            justify-content: center;
            gap: 1.8rem 2.5rem;
            border: 1px solid #2e404a;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(6px);
            width: fit-content;
            max-width: 100%;
            margin: 0 auto;
            flex-shrink: 0;
        }

        /* dimension group: icon, label, input + slider */
        .dim-group {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            gap: 6px;
            background: #1b252b;
            padding: 10px 18px;
            border-radius: 28px;
            border: 1px solid #324b55;
        }

        .dim-header {
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            color: #b4d4e0;
            font-size: 0.95rem;
            letter-spacing: 0.4px;
            width: 100%;
        }

        .dim-header i {
            width: 18px;
            height: 18px;
            stroke: #b0e0ff;
            stroke-width: 1.8;
        }

        .dim-controls {
            display: flex;
            align-items: center;
            gap: 12px;
            width: 100%;
            flex-wrap: wrap;
        }

        /* number input – no fixed min/max, validation in JS */
        .dim-controls input[type=number] {
            background: #1f2a30;
            border: 1px solid #3a535e;
            color: #e9f2f5;
            font-size: 1rem;
            padding: 6px 10px;
            width: 100px;
            border-radius: 30px;
            text-align: center;
            font-weight: 600;
            transition: all 0.15s;
            box-shadow: inset 0 2px 6px rgba(0, 0, 0, 0.6);
        }

        .dim-controls input[type=number]:focus {
            border-color: #62c6f2;
            outline: none;
            background: #25363e;
            box-shadow: 0 0 0 3px rgba(98, 198, 242, 0.2), inset 0 2px 6px #000;
        }

        /* range sliders – always represent pixels */
        .dim-controls input[type=range] {
            -webkit-appearance: none;
            appearance: none;
            width: 180px;
            height: 6px;
            background: #2a3a44;
            border-radius: 10px;
            outline: none;
            border: none;
            box-shadow: inset 0 1px 6px #0e1519;
        }

        .dim-controls input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #7ac7e0;
            border-radius: 50%;
            cursor: pointer;
            border: 2px solid #c2e6ff;
            box-shadow: 0 2px 10px #1e4f5e, 0 0 0 1px #0e1e24;
            transition: 0.1s;
        }

        .dim-controls input[type=range]::-webkit-slider-thumb:hover {
            background: #9ee4ff;
            transform: scale(1.15);
            border-color: white;
        }

        .dim-controls input[type=range]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #7ac7e0;
            border: 2px solid #c2e6ff;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 10px #1e4f5e;
        }

        .dim-controls input[type=range]::-moz-range-track {
            background: #2a3a44;
            height: 6px;
            border-radius: 10px;
            box-shadow: inset 0 1px 6px #0e1519;
        }

        /* right block: unit selector, hint, reset */
        .hint-reset {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 12px;
        }

        /* unit dropdown – sleek */
        .unit-selector {
            display: flex;
            align-items: center;
            gap: 8px;
            background: #0e1519;
            padding: 6px 16px;
            border-radius: 40px;
            border: 1px solid #30444c;
            color: #b0d4e0;
        }

        .unit-selector i {
            width: 16px;
            height: 16px;
            stroke: #b0e0ff;
        }

        .unit-selector select {
            background: transparent;
            border: none;
            color: #e0f0f5;
            font-size: 0.95rem;
            font-weight: 600;
            padding: 4px 8px;
            border-radius: 20px;
            outline: none;
            cursor: pointer;
        }

        .unit-selector select option {
            background: #141e24;
            color: #e0f0f5;
        }

        .dim-hint {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            color: #8daab3;
            font-size: 0.95rem;
            background: #0e1519;
            padding: 6px 20px;
            border-radius: 40px;
            border: 1px solid #30444c;
            white-space: nowrap;
        }

        .dim-hint i {
            width: 16px;
            height: 16px;
            stroke: #b0e0ff;
        }

        .reset-btn {
            background: #263b44;
            border: none;
            color: white;
            padding: 8px 24px;
            border-radius: 40px;
            font-size: 0.95rem;
            font-weight: 600;
            cursor: pointer;
            transition: 0.15s;
            border: 1px solid #3b6876;
            letter-spacing: 0.8px;
            white-space: nowrap;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .reset-btn i {
            width: 18px;
            height: 18px;
            stroke: white;
            stroke-width: 1.8;
        }

        .reset-btn:hover {
            background: #325c6b;
            border-color: #6bc8e6;
            box-shadow: 0 0 12px #1e4f5e;
        }

        /* ----- canvas container: perfect auto‑fit ----- */
        .canvas-wrapper {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            flex: 1 1 auto;
            min-height: 0;
            padding: 4px 0;
        }

        #canvas {
            image-rendering: crisp-edges;
            image-rendering: pixelated;
            -webkit-interpolation-mode: nearest-neighbor;
            -ms-touch-action: none;
            border: 2px solid #2a3a44;
            border-radius: 12px;
            box-shadow: 0 14px 28px rgba(0, 0, 0, 0.8);
            background: #000;
            max-width: 100%;
            max-height: 100%;
            width: auto;
            height: auto;
            object-fit: contain;
            transition: border 0.2s;
        }

        #canvas:active,
        #canvas:focus {
            border-color: #4fa3c9;
        }

        /* fullscreen */
        :-webkit-full-screen .canvas-wrapper {
            width: 100%;
            height: 100%;
        }

        :-webkit-full-screen #canvas {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        /* responsive */
        @media (max-width: 1000px) {
            .size-panel {
                flex-direction: column;
                padding: 1.5rem;
                border-radius: 32px;
                width: 100%;
            }

            .dim-group {
                width: 100%;
            }

            .dim-controls {
                justify-content: space-between;
            }

            .dim-controls input[type=range] {
                width: 140px;
            }

            .hint-reset {
                flex-direction: row;
                flex-wrap: wrap;
                justify-content: center;
            }
        }

        @media (max-width: 600px) {
            .dim-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .dim-controls input[type=range] {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <script src="/assets/js/script.js?v=14"></script>

    <div class="gm4html5" id="gm4html5">

        <!-- ==========  CONTROL PANEL – UNITS, SLIDERS, LUCIDE ========== -->
        <div class="size-panel">
            <!-- WIDTH group -->
            <div class="dim-group">
                <div class="dim-header">
                    <i data-lucide="square"></i>
                    <span>WIDTH</span>
                </div>
                <div class="dim-controls">
                    <input type="number" id="canvas-width" value="1000" step="any" autocomplete="off">
                    <input type="range" id="width-slider" min="200" max="2560" value="1000" step="1">
                </div>
            </div>

            <!-- HEIGHT group -->
            <div class="dim-group">
                <div class="dim-header">
                    <i data-lucide="square"></i>
                    <span>HEIGHT</span>
                </div>
                <div class="dim-controls">
                    <input type="number" id="canvas-height" value="1000" step="any" autocomplete="off">
                    <input type="range" id="height-slider" min="200" max="1440" value="1000" step="1">
                </div>
            </div>

            <!-- UNIT SELECTOR + HINT + RESET -->
            <div class="hint-reset">
                <div class="unit-selector">
                    <i data-lucide="ruler"></i>
                    <select id="unit-select">
                        <option value="px" selected>px (pixels)</option>
                        <option value="in">in (inches)</option>
                        <option value="cm">cm (centimeters)</option>
                        <option value="mm">mm (millimeters)</option>
                        <option value="pt">pt (points)</option>
                        <option value="pc">pc (picas)</option>
                    </select>
                </div>
                <span class="dim-hint" id="dimension-hint">
                    <i data-lucide="zap"></i>
                    <span>1000 x 1000</span> <span style="color:#94a9b3;">px</span>
                </span>
                <button class="reset-btn" id="reset-size" title="restore 1000x1000">
                    <i data-lucide="rotate-ccw"></i>
                    RESET
                </button>
            </div>
        </div>

        <!-- canvas wrapper: auto‑fit magic -->
        <div class="canvas-wrapper">
            <canvas id="canvas" width="1000" height="1000">
                <p>Your browser doesn't support HTML5 canvas.</p>
            </canvas>
        </div>
    </div>

    <!-- original game engine -->
    <script type="text/javascript" src="html5game/Coding_BreakOut1.js"></script>

    <!-- ==========  DYNAMIC CANVAS – REAL UNITS, SLIDERS, AUTO‑FIT ========== -->
    <script>
        (function() {
            "use strict";

            // ----- DOM elements -----
            const canvas = document.getElementById('canvas');
            const widthInput = document.getElementById('canvas-width');
            const heightInput = document.getElementById('canvas-height');
            const widthSlider = document.getElementById('width-slider');
            const heightSlider = document.getElementById('height-slider');
            const hintSpan = document.getElementById('dimension-hint');
            const hintText = hintSpan.querySelector('span'); // first span (pixel value)
            const unitSelect = document.getElementById('unit-select');
            const resetBtn = document.getElementById('reset-size');

            // ----- CONVERSION: 1 inch = 96px (standard CSS) -----
            const PX_PER_IN = 96;
            const CONVERSION = {
                'px': 1,
                'in': PX_PER_IN,
                'cm': PX_PER_IN / 2.54,
                'mm': PX_PER_IN / 25.4,
                'pt': PX_PER_IN / 72,
                'pc': PX_PER_IN / 6
            };

            // current unit (default 'px')
            let currentUnit = 'px';

            // ----- helper: convert pixels to current unit (with nice rounding) -----
            function pixelsToUnit(px, unit) {
                if (unit === 'px') return Math.round(px);
                const value = px / CONVERSION[unit];
                // show 2 decimals for in/cm/mm, 1 for pt/pc, 0 for px
                if (unit === 'in' || unit === 'cm' || unit === 'mm') return value.toFixed(2);
                if (unit === 'pt' || unit === 'pc') return value.toFixed(1);
                return px; // fallback
            }

            // ----- helper: convert from unit value to pixels (round to nearest integer) -----
            function unitToPixels(value, unit) {
                const num = parseFloat(value);
                if (isNaN(num)) return 200; // fallback
                if (unit === 'px') return Math.round(num);
                return Math.round(num * CONVERSION[unit]);
            }

            // ----- update all controls from pixel dimensions -----
            function updateControlsFromPixels(pixelW, pixelH) {
                // clamp pixel dimensions
                pixelW = Math.min(3840, Math.max(200, pixelW));
                pixelH = Math.min(2160, Math.max(200, pixelH));

                // update canvas if needed
                if (canvas.width !== pixelW || canvas.height !== pixelH) {
                    canvas.width = pixelW;
                    canvas.height = pixelH;
                    canvas.setAttribute('width', pixelW);
                    canvas.setAttribute('height', pixelH);
                }

                // update sliders (pixels)
                widthSlider.value = pixelW;
                heightSlider.value = pixelH;

                // update numeric inputs (converted to current unit)
                widthInput.value = pixelsToUnit(pixelW, currentUnit);
                heightInput.value = pixelsToUnit(pixelH, currentUnit);

                // update hint (always show pixels)
                hintText.innerText = `${pixelW} x ${pixelH}`;
            }

            // ----- set canvas size from two pixel values -----
            function setCanvasSize(pixelW, pixelH) {
                pixelW = Math.min(3840, Math.max(200, parseInt(pixelW, 10) || 1000));
                pixelH = Math.min(2160, Math.max(200, parseInt(pixelH, 10) || 1000));
                updateControlsFromPixels(pixelW, pixelH);
            }

            // ----- event handlers with debounce (smooth) -----
            let debounceTimer;

            // ----- WIDTH: input from number (current unit) -----
            widthInput.addEventListener('input', function(e) {
                clearTimeout(debounceTimer);
                const wUnit = this.value;
                const hUnit = heightInput.value;
                const pixelW = unitToPixels(wUnit, currentUnit);
                const pixelH = unitToPixels(hUnit, currentUnit);
                // keep slider in sync (pixels)
                widthSlider.value = pixelW;
                debounceTimer = setTimeout(() => {
                    setCanvasSize(pixelW, pixelH);
                }, 20);
            });

            widthInput.addEventListener('change', function(e) {
                clearTimeout(debounceTimer);
                const pixelW = unitToPixels(this.value, currentUnit);
                const pixelH = unitToPixels(heightInput.value, currentUnit);
                setCanvasSize(pixelW, pixelH);
            });

            // ----- HEIGHT: input from number (current unit) -----
            heightInput.addEventListener('input', function(e) {
                clearTimeout(debounceTimer);
                const wUnit = widthInput.value;
                const hUnit = this.value;
                const pixelW = unitToPixels(wUnit, currentUnit);
                const pixelH = unitToPixels(hUnit, currentUnit);
                heightSlider.value = pixelH;
                debounceTimer = setTimeout(() => {
                    setCanvasSize(pixelW, pixelH);
                }, 20);
            });

            heightInput.addEventListener('change', function(e) {
                clearTimeout(debounceTimer);
                const pixelW = unitToPixels(widthInput.value, currentUnit);
                const pixelH = unitToPixels(this.value, currentUnit);
                setCanvasSize(pixelW, pixelH);
            });

            // ----- WIDTH slider (direct pixels) -----
            widthSlider.addEventListener('input', function(e) {
                clearTimeout(debounceTimer);
                const pixelW = parseInt(this.value, 10);
                const pixelH = parseInt(heightSlider.value, 10);
                // convert pixelW to current unit and set input
                widthInput.value = pixelsToUnit(pixelW, currentUnit);
                debounceTimer = setTimeout(() => {
                    setCanvasSize(pixelW, pixelH);
                }, 10);
            });
            widthSlider.addEventListener('change', function(e) {
                clearTimeout(debounceTimer);
                const pixelW = parseInt(this.value, 10);
                const pixelH = parseInt(heightSlider.value, 10);
                setCanvasSize(pixelW, pixelH);
            });

            // ----- HEIGHT slider -----
            heightSlider.addEventListener('input', function(e) {
                clearTimeout(debounceTimer);
                const pixelW = parseInt(widthSlider.value, 10);
                const pixelH = parseInt(this.value, 10);
                heightInput.value = pixelsToUnit(pixelH, currentUnit);
                debounceTimer = setTimeout(() => {
                    setCanvasSize(pixelW, pixelH);
                }, 10);
            });
            heightSlider.addEventListener('change', function(e) {
                clearTimeout(debounceTimer);
                const pixelW = parseInt(widthSlider.value, 10);
                const pixelH = parseInt(this.value, 10);
                setCanvasSize(pixelW, pixelH);
            });

            // ----- UNIT CHANGE: recalc inputs from current pixels, update step behavior -----
            unitSelect.addEventListener('change', function(e) {
                currentUnit = this.value;
                // get current pixel dimensions from canvas
                const pixelW = canvas.width;
                const pixelH = canvas.height;
                // update numeric inputs with new unit
                widthInput.value = pixelsToUnit(pixelW, currentUnit);
                heightInput.value = pixelsToUnit(pixelH, currentUnit);
                // adjust step for easier input
                if (currentUnit === 'px') {
                    widthInput.step = 1;
                    heightInput.step = 1;
                } else {
                    widthInput.step = 'any';
                    heightInput.step = 'any';
                }
            });

            // ----- RESET to 1000x1000 pixels -----
            resetBtn.addEventListener('click', function() {
                setCanvasSize(1000, 1000);
            });

            // ----- MutationObserver: if game modifies canvas, reflect in UI -----
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mut) {
                    if (mut.attributeName === 'width' || mut.attributeName === 'height') {
                        const newW = canvas.getAttribute('width');
                        const newH = canvas.getAttribute('height');
                        if (newW && newH) {
                            updateControlsFromPixels(parseInt(newW,10), parseInt(newH,10));
                        }
                    }
                });
            });
            observer.observe(canvas, { attributes: true });

            // ----- INITIAL AUTO‑FIT: set canvas size to fit page (pixels) -----
            function setInitialSize() {
                // 80% of viewport, but capped between 200 and 2560/1440
                let vw = window.innerWidth * 0.8;
                let vh = window.innerHeight * 0.8;
                let initW = Math.min(2560, Math.max(200, Math.floor(vw)));
                let initH = Math.min(1440, Math.max(200, Math.floor(vh)));
                // nice round numbers (optional)
                initW = Math.round(initW / 10) * 10;
                initH = Math.round(initH / 10) * 10;
                setCanvasSize(initW, initH);
            }

            // call after a tiny delay to let everything load
            window.addEventListener('load', function() {
                setTimeout(() => {
                    setInitialSize();
                    // also fire lucide icons
                    if (typeof lucide !== 'undefined' && lucide.createIcons) lucide.createIcons();
                }, 30);
            });

            // also run now (if load already passed)
            if (document.readyState === 'complete') {
                setInitialSize();
            } else {
                window.addEventListener('load', setInitialSize);
            }

            // initial sync of unit dropdown, step
            currentUnit = unitSelect.value;
            if (currentUnit !== 'px') {
                widthInput.step = 'any';
                heightInput.step = 'any';
            }

            // prevent non-numeric in number inputs (but allow decimal point)
            function allowNumericAndDot(e) {
                const key = e.key;
                if (key === '.' || key === 'Decimal' || key === 'Backspace' || key === 'Delete' || key === 'ArrowLeft' || key === 'ArrowRight' || key === 'Tab' || key === 'Enter' || key === 'Home' || key === 'End') return true;
                if (!/[\d]/.test(key)) {
                    e.preventDefault();
                }
            }
            widthInput.addEventListener('keydown', allowNumericAndDot);
            heightInput.addEventListener('keydown', allowNumericAndDot);

            // Lucide icons (also called on load)
            if (typeof lucide !== 'undefined' && lucide.createIcons) lucide.createIcons();
        })();
    </script>

    <!-- original GameMaker init -->
    <script>
        window.onload = GameMaker_Init;
    </script>

    <!-- Cloudflare beacon -->
    <script defer
        src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015"
        integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ=="
        data-cf-beacon='{"version":"2024.11.0","token":"0e9b0b0f62fc491faca192e141c6b8c1","r":1,"server_timing":{"name":{"cfCacheStatus":true,"cfEdge":true,"cfExtPri":true,"cfL4":true,"cfOrigin":true,"cfSpeedBrain":true},"location_startswith":null}}'
        crossorigin="anonymous"></script>
</body>

</html>
